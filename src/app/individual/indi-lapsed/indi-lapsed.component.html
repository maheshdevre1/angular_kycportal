<div class="export-heading">
  <mat-card class="export-card">
    <h3 class="export-title">LAPSED RECORDS</h3>

  </mat-card>
</div>

<div class="content-card">
  <mat-card class="mat-content-card">
    <div class="content-card-header">
      <h3>1) Records without response even after one month of batch processing</h3>
      <h3>2) If confirmation not received for probable match customers</h3>
    </div>

    <div class=button-row>





      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton"
          data-bs-toggle="dropdown" aria-expanded="false">
          {{ selectedOption }}
        </button>

        <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
          <li><a class="dropdown-item" (click)="selectOption('All Data')">All Data</a></li>
          <li><a class="dropdown-item" (click)="selectOption('Customer Id')">Customer Id</a></li>
        </ul>
      </div>

      <span class="tooltip-wrapper">


        <button class="btn btn-primary" type="button" [disabled]="getSelectedRows().length === 0"
          (click)="reprocessLapsedRecord()">
          Reprocess
        </button>

        <!-- Tooltip text -->
        <span class="tooltip-text" *ngIf="getSelectedRows().length === 0">
          Please select at least one record to reprocess
        </span>
      </span>



      <input *ngIf="selectedOption === 'Customer Id'" type="text" class="batch-input" placeholder="Enter CIF No"
        [(ngModel)]="customerId">
      <button class="search" *ngIf="selectedOption === 'Customer Id'" (click)="searchByCustomerId()">
        Search
      </button>
      <input type="text" class="custom-search-input" placeholder="Custom Search" />

    </div>


    <div class="table-css">
      <!-- Table for branch summary -->
      <table class="table table-striped table-bordered text-center">
        <thead class="column-css">

          <tr>
            <th>
              <input type="checkbox" [(ngModel)]="selectAll" (change)="toggleSelectAll()" />
            </th>
            <th>Branch </th>
            <th>Customer Id </th>
            <th>Name</th>
            <th>Batch No</th>
            <th>Batch Processing Date</th>
            <th>Error</th>

          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of tableData; let i = index">
            <td>
              <input type="checkbox" [(ngModel)]="item.selected" (change)="checkIfAllSelected()" />
            </td>
            <td>{{item.branchId}}</td>
            <td>{{item.customerID}}</td>
            <td>{{item.name}}</td>
            <td>{{item.batchNo}}</td>
            <td>{{item.batchProcessingDate}}</td>
            <td>{{item.errorMessage}}</td>

          </tr>
        </tbody>
      </table>
    </div>

    <!-- Pagination -->




  </mat-card>
  <div class="paginator" *ngIf="totalCount >= pageSize">
    <mat-paginator [length]="totalCount" [pageSize]="pageSize" [pageIndex]="pageIndex"
      [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page" (page)="onPageChange($event)">
    </mat-paginator>
    <br>
    <br>
    <br>
    <br>
  </div>
</div>