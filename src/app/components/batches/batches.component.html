<div class="bootstrap-wrapper">
    <div class="container-fluid">
        <mat-card class="batches-card" appearance="outlined">
            <mat-card-header>
                <mat-card-title>Batches</mat-card-title>
            </mat-card-header>
        </mat-card>
        <div class=button-row>
            <!-- <button class="dropdown-btn">All Data</button> -->
            <div class="dropdown">
                <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton"
                    data-bs-toggle="dropdown" aria-expanded="false">
                    {{ selectedOption }}
                </button>

                <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <li><a class="dropdown-item" (click)="selectOption('All Data')">All Data</a></li>
                    <li><a class="dropdown-item" (click)="selectOption('Batch Number')">Batch Number</a></li>
                </ul>
            </div>
            <input *ngIf="selectedOption === 'Batch Number'" type="text" class="batch-input"
                placeholder="Enter Batch No" [(ngModel)]="batchNo">
            <button class="search" *ngIf="selectedOption === 'Batch Number'" (click)="searchByBatch()">
                Search
            </button>
            <input type="text" class="custom-search-input" placeholder="Custom Search" [(ngModel)]="customSearchText"
                (input)="onCustomSearch()" />
            <input type="file" #fileInput style="display:none;" (change)="onFileSelected($event)" />
            <button class="app-btn" (click)="openFile(1)">Stage1</button>
            <button class="app-btn" (click)="openFile(2)">Periodic</button>
        </div>

        <!-- Table -->
        <div class="table-css">
            <table class="table table-striped table-bordered text-center">
                <thead class="column-css">
                    <tr>
                        <th colspan="5" class="main-header">Batches</th>
                        <th colspan="2" class="main-header">Stage 1 Response</th>
                    </tr>
                    <tr>
                        <th>Batch</th>
                        <th>Zip Files</th>
                        <th>Download Batch</th>
                        <th>Batch Type</th>
                        <th>Created On</th>
                        <th>Processed</th>
                        <th>Download</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let b of batchesList; let i = index">
                        <td>{{ b.batch }}</td>
                        <td>
                            {{ b.zipFiles }}

                            <button class="edit-btn" (click)="batchesDateUpdate(b.batch)">
                                Edit
                            </button>
                        </td>
                        <td>
                            <button>
                                <mat-icon (click)="downloadBatch(b.batch)">
                                    download
                                </mat-icon>
                            </button>
                        </td>
                        <td>{{ b.batchType }}</td>
                        <td>{{ b.createdOn }}</td>
                        <td>
                            <mat-icon *ngIf="b.responseProcessed === 'true'"
                                class="icon-success">check_circle</mat-icon>
                            <mat-icon *ngIf="b.responseProcessed === 'false'" class="icon-error">cancel</mat-icon>
                        </td>

                        <td>
                            <mat-icon *ngIf="b.responseUploaded === 'true'" class="icon-success">check_circle</mat-icon>
                            <mat-icon *ngIf="b.responseUploaded === 'false'" class="icon-error">cancel</mat-icon>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <!-- Pagination -->
        <div class="paginator" *ngIf="selectedOption === 'All Data' && !(customSearchText?.trim())">
            <mat-paginator [length]="totalBatchesCount" [pageSize]="pageSize" [pageIndex]="pageIndex"
                [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page" (page)="onPageChange($event)">
            </mat-paginator>
            <br>
            <br>
            <br>
        </div>
    </div>
</div>